<!DOCTYPE html>
<html>
<head>
<title>Smart Signage Player</title>
<style>
body{
  margin:0;
  background:black;
  overflow:hidden;
}
#video,#image,#pdf{
  width:100vw;
  height:100vh;
}
</style>
</head>
<body>

<video id="video" autoplay></video>
<img id="image">
<iframe id="pdf"></iframe>

<script>
const DEVICE_ID = "SCREEN_001";
let playlist = [];
let index = 0;

async function loadPlaylist(){
  let res = await fetch("http://localhost:5000/api/playlist/" + DEVICE_ID);
  playlist = await res.json();
}

function playNext(){
  if(playlist.length === 0) return;

  let item = playlist[index];

  video.style.display="none";
  image.style.display="none";
  pdf.style.display="none";

  if(item.type === "videos"){
    video.src = item.url;
    video.style.display="block";
    video.onended = playNext;
  }
  else if(item.type === "images"){
    image.src = item.url;
    image.style.display="block";
    setTimeout(playNext, 8000);
  }
  else if(item.type === "pdfs"){
    pdf.src = item.url;
    pdf.style.display="block";
    setTimeout(playNext, 15000);
  }

  index = (index + 1) % playlist.length;
}

async function start(){
  await loadPlaylist();
  playNext();
}

start();
</script>

</body>
</html>
